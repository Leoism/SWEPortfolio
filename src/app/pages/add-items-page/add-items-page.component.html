<h2>Add A New Entry</h2>
<mat-dialog-content>
  <mat-form-field appearance="outline" class="category-select">
    <mat-label>Category</mat-label>
    <mat-select [formControl]="categoryControl">
      <mat-option value="work">Work Experience</mat-option>
      <mat-option value="project">Project</mat-option>
      <mat-option value="course">Coursework</mat-option>
    </mat-select>
  </mat-form-field>
  <!-- Only render the appropriate form when they are selected -->
  <ng-container *ngIf="categoryControl.value === 'work' then workForm"></ng-container>
  <ng-container *ngIf="categoryControl.value === 'project' then projectsForm"></ng-container>
  <ng-container *ngIf="categoryControl.value === 'course' then courseForm"></ng-container>
</mat-dialog-content>

<ng-template #workForm>
  <form [formGroup]="entryGroup" class="flex-container">
    <mat-form-field appearance="outline" class="flex-item">
      <mat-label>Company</mat-label>
      <input matInput formControlName="workCompany">
      <mat-icon matSuffix>work_outline</mat-icon>
    </mat-form-field>
    <mat-form-field appearance="outline" class="flex-item">
      <mat-label>Title</mat-label>
      <input matInput formControlName="workTitle">
      <mat-icon matSuffix>person_outline</mat-icon>
    </mat-form-field>
    <mat-form-field appearance="outline" class="flex-item">
      <mat-label>Year</mat-label>
      <input matInput formControlName="workYear">
      <mat-icon matSuffix>calendar_today</mat-icon>
    </mat-form-field>
  </form>
  <ng-container *ngTemplateOutlet="bulletForm"></ng-container>
</ng-template>

<ng-template #projectsForm>
  <form [formGroup]="entryGroup" class="flex-container">
    <mat-form-field appearance="outline" class="flex-item">
      <mat-label>Name</mat-label>
      <input matInput formControlName="projectName">
      <mat-icon matSuffix>text_fields</mat-icon>
    </mat-form-field>
    <mat-form-field appearance="outline" class="flex-item">
      <mat-label>Link</mat-label>
      <input matInput formControlName="projectLink">
      <mat-icon matSuffix>link</mat-icon>
    </mat-form-field>
    <mat-form-field appearance="outline" class="flex-item">
      <mat-label>Year</mat-label>
      <input matInput formControlName="projectYear">
      <mat-icon matSuffix>calendar_today</mat-icon>
    </mat-form-field>
  </form>
  <ng-container *ngTemplateOutlet="bulletForm"></ng-container>
</ng-template>

<ng-template #courseForm>
  <form [formGroup]="entryGroup" class="flex-container">
    <!-- Display categories available or make a new one -->
    <mat-form-field appearance="outline" class="category-select flex-item">
      <mat-label>Course Category</mat-label>
      <mat-select [formControl]="courseCategoryControl">
        <mat-option *ngFor="let category of courseCategories"
                    [value]=category>{{category}}</mat-option>
        <mat-option value="New Category">New Category</mat-option>
      </mat-select>
    </mat-form-field>
    <!-- Category name input for when it is selected -->
    <mat-form-field *ngIf="courseCategoryControl.value === 'New Category'"
                    appearance="outline" class="flex-item">
      <mat-label>New Category Name</mat-label>
      <input matInput formControlName="newCategory">
      <mat-icon matSuffix>text_fields</mat-icon>
    </mat-form-field>
    <!-- Name of the course to add -->
    <mat-form-field appearance="outline" class="flex-item">
      <mat-label>Course</mat-label>
      <input matInput #courseInput formControlName="courseName">
      <mat-error>Course name cannot be empty</mat-error>
    </mat-form-field>
    <!-- Statuses are optional and appear as a tooltip when displayed -->
    <mat-form-field appearance="outline" class="flex-item-min">
      <mat-label>Status</mat-label>
      <input matInput #courseStatus formControlName="courseStatus">
      <mat-hint>Optional. e.g: in progress</mat-hint>
    </mat-form-field>
    <button mat-stroked-button class="course-add-button"
            (click)="addCourse(courseInput.value, courseStatus.value)"
      [disabled]="courseInput.value.trim() === ''">
      <mat-icon>add</mat-icon>
    </button>
  </form>
  <div>
    <!-- All the courses to be added -->
    <h3>Courses:</h3>
    <mat-selection-list #courseList>
      <mat-list-option *ngFor="let course of courses" [value]="course">{{course.status.length > 0 ? course.name + ' | status: ' + course.status : course.name}}</mat-list-option>
    </mat-selection-list>
    <div>
      <button mat-button (click)="deleteCourses(courseList.selectedOptions.selected)">
        Delete {{courseList.selectedOptions.selected.length}} courses</button>
      <button mat-button (click)="saveEntry()" [disabled]="isFormEmpty">Save Entry</button>
    </div>
  </div>
</ng-template>

<ng-template #bulletForm>
  <div class="bullet-flex">
    <mat-form-field appearance="outline" class="bullet-entry">
      <mat-label>Bullet</mat-label>
      <input matInput #bulletInput [formControl]="bulletControl">
      <mat-icon matSuffix>format_list_bulleted</mat-icon>
      <mat-error>Bullet cannot be empty</mat-error>
    </mat-form-field>
    <button mat-stroked-button class="bullet-add-button"
            (click)="addBullet(bulletInput.value)"
            [disabled]="bulletControl.invalid">
      <mat-icon>add</mat-icon>
    </button>
  </div>
  <h3>Bullets:</h3>
  <mat-selection-list #bulletList>
    <mat-list-option *ngFor="let bullet of bullets" [value]="bullet">{{bullet}}</mat-list-option>
  </mat-selection-list>
  <div>
    <button mat-button (click)="deleteBullets(bulletList.selectedOptions.selected)">
      Delete {{bulletList.selectedOptions.selected.length}} bullets</button>
    <button mat-button (click)="saveEntry()"
            [disabled]="isFormEmpty">Save Entry</button>
  </div>
</ng-template>
